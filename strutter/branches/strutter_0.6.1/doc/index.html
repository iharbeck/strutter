<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<style>

  BODY { font-family: sans-serif;  }
  PRE { border-style: solid; border-width: 1px; background-color: aliceblue; padding: 10px }
  TABLE { border-collapse: collapse; border-style: solid; border-width: 1px; border-color: gray}
  TD { border-collapse: collapse; border-style: solid; border-width: 1px;
   border-color: black; padding: 3px; font-size: 11px}

  H1 { font-size: 16px ;
  	  color: darkred;
  	  background: silver;
     border-collapse: collapse; border-style: solid;
     border-width: 1px; border-color: black; padding: 3px}

  .menu1 { font-weight: bold; font-size: 12px;border-bottom-width: 1px;border-bottom-style: solid; border-bottom-color: black; width: 100% }
  .menu2 { font-weight: normal; font-size: 11px; margin-left: 0px; margin-top: 5px;
  		   border-width: 1px;
           border-style: solid;
           border-color: black; width: 100%;
           padding-left: 3px;
           background-color: gray; color: white
         }
  .menu3 { font-weight: normal; font-size: 11px; margin-left: 15px; margin-top: 5px}

  .menu1a { text-decoration: none; color: white }
  .menu3a { text-decoration: none; color: black }
</style>

<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<BODY>

<table>
<tr>
<td width="160" valign="top">

<div style="width: 160px; padding: 5px; background-color: silver; border: 1px; border-style: solid; " >

	<div class="menu1">Strutter 0.6.1</div>
	<div class="menu3"><a href="http://sourceforge.net/project/showfiles.php?group_id=167343&package_id=190307" target="blank" class="menu3a">Download</a></div>

	<div class="menu2"><a href="#strutterconfig" class="menu1a">Strutter Config</a></div>
	<div class="menu3"><a href="#strutterconfigexample" class="menu3a">Example</a></div>
	<div class="menu3"><a href="#strutterconfiginstall" class="menu3a">Installation</a></div>

	<div class="menu2"><a href="#strutterview" class="menu1a">Strutter View</a></div>
	<div class="menu3"><a href="#strutterviewexample" class="menu3a">Example</a></div>
	<div class="menu3"><a href="#strutterviewerror" class="menu3a">Error handler</a></div>
	<div class="menu3"><a href="#strutterviewinstall" class="menu3a">Installation</a></div>

	<div class="menu2"><a href="#struttergimmicks" class="menu1a">Extentions</a></div>

	<div class="menu3"><a href="#struttergimmicksformless" class="menu3a">ActionHelper</a></div>
	<div class="menu3"><a href="#struttergimmicksformless" class="menu3a">Formless Action</a></div>
	<div class="menu3"><a href="#struttergimmicksformless" class="menu3a">Plain Action</a></div>
	<div class="menu3">TokenInterceptor</div>



</div>

</td>
<td>
<H1>Strutter</H1>
<b>Strutter</b> is an open-source extention to the web application framework
<a href="http://struts.apache.org" target="blank">Apache Struts</a>.<p>

The configuration of Struts is done in a central XML configuation file
(struts-config.xml).<br>
The goal of Strutter is to reduce and automate the configuration effort in XML by following conventions. 
In most projects you will never touch it again.<p>

I experienced a lot of stupid and error prone copy-past tasks in my Struts development
cycle. I try to eliminate them with this project. Finding target for my <code>ActionForwards</code> 
frustrated me in large struts-config.xml files. Sharing a single file in a multi developer
project is no big fun also.<p>

With Strutter all configuration is stored within the action itself.
It's a tag interface configuration concept.
The configuration is done directly in the code and you can use the code completion features
provided by your IDE. This eliminates typing of full qualified classname for Actions or ActionForms.
<p>

Best of all, you don't need to switch legacy systems to the Strutter configuration concept completly.
This extention can run in parallel with your existing struts configuration file.<p>

The core of this extention is <b>Strutter Config</b> it will handle the configuration. <p>

<b>Strutter View</b> is an optional part designed to extend the view of Struts MVC model. <p>
It is the result of expiriences with the Struts tag library in a lot of projects.
Strutter View will automatically map the ActionForm attributes to the HTML form elements.
This is done by the <code>name</code> attribute of the elements. Strutter is parsing the final HTML
provided in the request and fills in all missing data. 
It can handle pages provided as JSPs or from other scripting engines.<br>
The goal is standard HTML. Because the requests are handled by the container first - you still
have the option to mix up with the old fashioned way too.<p>

<b>Strutter Extentions</b>. Strutter provides entended versions of the default
<code>Action</code> and <code>ActionDispatcher</code> making live a little easier and
provides <code>execute</code> functions without parameter. The <code>FormlessInterface</code> 
interface provides a simple way to get rid off the additional <code>ActionForm</code>. All form attributes
can be added to the action itself.



<H1>Strutter Config</H1>


<B>Features</B>
<LI>Configure Struts by following conventions
<LI>Configure less and in your action class with code completion
<LI>Compatible with your existing Struts configuration
<LI>(Option) Formless Actions (Thread Safe)
<LI>Package by layer(some folder) or feature(JSPs next to your classes)
<LI>(Option) Interceptors


<P><B>The default conventions</B>
<LI>Action and corresponding ActionFrom (if any) are located in the same folder
<LI>Action and ActionForm classname end with a suffix like Action and ActionForm

<LI>Action and ActionForm are starting with the same prefix
<LI>Action prefix is simular to the Actions classname
<LI>ActionForm name equals ActionForm classname
<LI>(Option) JSPs end with ActionForward's name

<P><B>Benefits</B>
<LI>Reduce copy and past
<LI>Reduce configuration
<LI>Reduce errors
<LI>Better support for development in teams
<LI>Codecompletion without plugins
<LI>Compatible with JDK1.4

<P><B><a name="strutterconfigexample">Example 1 (Dispatcher Pattern)</a></B><BR>
<PRE>/* The Action */
package example;

public class CustomerAction extends ActionDispatcher implements ConfigInterface
{
  public void config(ActionConfig struts) {
    struts.addForward("/customer_view.jsp");
  }
  
  ...
}
</PRE>

<PRE>/* Optional ActionForm Class (is found by classname matching) */
package example;

public class CustomerActionForm extends ActionForm
{
  ...
}
</PRE>

<b>Example 2 (Multiple Action Pattern)</b><br>

<PRE>/* The Action */
package example;

public class CustomerEditAction extends Action implements ConfigInterface
{
  public void config(ActionConfig struts) {
    struts.addForward("/customer_view.jsp");
  }
}
</PRE>

<PRE>/* Optional ActionForm Class */
package example;

public class CustomerEditActionForm extends ActionForm
{
  ...
}

or

public class CustomerActionForm extends ActionForm
{
  ...
}
</PRE>




<P><b>Behind the scenes: Equivalent configuration (Dispatcher Pattern):</b><BR><PRE>&lt;form-beans&gt;
    &lt;form-bean name="CustomerActionForm" type="example.CustomerActionForm" /&gt;
&lt;/form-beans&gt;
</PRE><PRE>&lt;action-mappings&gt;
    &lt;action name="CustomerActionForm"
            type="example.CustomerAction"
            parameter="action"
            scope="session"
            path="/customer"&gt;
            &lt;forward name="view" path="/customer_view.jsp" /&gt;
    &lt;/action&gt;
&lt;/action-mappings&gt;
</PRE>

All struts configuration is done dynamically during the startup of the struts plugin modules.

<p>

<B><a name="strutterconfiginstall">Installation</a></B><BR>
Strutter Config is implemented as Struts
Plugin. To setup with default configuration just add the
<CODE>stutter.jar</CODE> and <code>htmlparser.jar</code> to your WEB-INF/lib and add the following tag to your
struts-config.xml. <PRE>&lt;plug-in className="strutter.config.ActionPlugin" /&gt;
</PRE>

That's it! The plugin searches your classpath for classes
implementing 
<li><code>ConfigInterface</code> 
<li><code>ConfigZeroInterface</code>
<li><code>ConfigWSInterface</code>
<li><code>ConfigAutorunInterface</code>
<li><code>ConfigRemoteInterface</code>
and will add the actions configuration programmatically on your applications startup.

<P><B>Customize conventions</B>
<BR>You can change some of default behavier.
<PRE>&lt;plug-in className="strutter.config.ActionPlugin"&gt;
    	&lt;set-property property="packageroot"  value="action"/&gt;
    	&lt;set-property property="aliasaction"  value="Action"/&gt;
    	&lt;set-property property="aliasform"    value="ActionForm"/&gt;
    	&lt;set-property property="aliasview"    value="view,list,update,create"/&gt;
    	&lt;set-property property="pathformat"   value="{PATH}"/&gt;
    	&lt;set-property property="pathlower"    value="0"/&gt;
    	&lt;set-property property="parameter"    value="action"/&gt;
    	&lt;set-property property="scope"        value="session"/&gt;
    	&lt;set-property property="views"        value="views"/&gt;

    	&lt;set-property property="encoding"     value="UTF-8"/&gt;
    	&lt;set-property property="viewer"       value="1"/&gt;
    	&lt;set-property property="keepalive"    value="1"/&gt;
    	&lt;set-property property="script"       value="1"/&gt;
    	&lt;set-property property="template"     value="1"/&gt;

    	&lt;set-property property="packageby"    value="layer"/&gt;
   
&lt;/plug-in&gt;
</PRE>
<TABLE border=1>
  <TBODY>
  <TR>
    <TD><B>name</B></TD>
    <TD><B>default</B></TD>
    <TD><B>description</B></TD></TR>
  <TR>
    <TD>packageroot</TD>
    <TD>action</TD>
    <TD>Comma separated list of package path</TD></TR>
  <TR>
    <TD>aliasaction</TD>
    <TD>Action</TD>
    <TD>Suffix to identify ActionClass</TD></TR>
  <TR>
    <TD>aliasform</TD>
    <TD>ActionForm</TD>
    <TD>Suffix to identify ActionFormClass</TD></TR>
  <TR>
    <TD>aliasview</TD>
    <TD>view,list,update,create</TD>
    <TD>Suffix of default views (used only if no other forwards are provided) Example: actionname_alias.jsp</TD></TR>
  <TR>
    <TD>pathformat</TD>
    <TD>{PATH}</TD>
    <TD>Formatting of Actionpath. Example "Frm{PATH}" to add Frm in front of
      PATH generated from the action's classname</TD></TR>
  <TR>
    <TD>pathlower</TD>
    <TD>0</TD>
    <TD>1: convert PATH to lower, 0: PATH is unchanged</TD></TR>

  <TR>
    <TD>parameter</TD>
    <TD>action</TD>
    <TD>Parameter for DispatcherAction alias variable</TD></TR>

  <TR>
    <TD>views</TD>
    <TD>views</TD>
    <TD>Default folder storing JSPs</TD></TR>

  <TR>
    <TD>encoding</TD>
    <TD>UTF-8</TD>
    <TD>Default Encoding for rendered page</TD></TR>

  <TR>
    <TD>viewer</TD>
    <TD>1</TD>
    <TD>1:Render HTML Tags (please see) Strutter View 0:disabled</TD></TR>
  
  <TR>
    <TD>keepalive</TD>
    <TD>1</TD>
    <TD>1:AJAX request is send to keep session alive 0:disabled</TD></TR>
  <TR>
    <TD>script</TD>
    <TD>1</TD>
    <TD>1:Support Javascript is render 0:disabled</TD></TR>
  <TR>
    <TD>template</TD>
    <TD>1</TD>
    <TD>1:Support HTML for background processing is render 0:disabled</TD></TR>
 
  <TR>
    <TD>packageby</TD>
    <TD>layer</TD>
    <TD>layer:Get JSP from folder relative to WEB ROOT package:lookup in class folder</TD></TR>


  </TBODY></TABLE>
<P><B>Optional configuration</B><BR>The following functions you can
overwrite the configuration generated by the plugin.
<PRE>  struts.addForward("view", "/customer_view.jsp", [redirect:false]);
  struts.addForward("/customer_view.jsp", [redirect:false]);

  struts.addGlobalForward("view", "/customer_view.jsp", [redirect:false]);
  struts.addGlobalForward("/customer_view.jsp", [redirect:false]);

  struts.setPackageby(ActionConfig.PACKAGEBY_FEATURE);
  struts.setForm(CustomerActionForm.class);
  struts.setValidate(false);
  struts.setInput("/customer_input.jsp");
  struts.setParameter("action");
  struts.setPath("/customer");
  struts.setScope("session");
  struts.setUnknown(false);
  struts.setRoles("role1,role2");
</PRE>

<TABLE border=1>
  <TBODY>
  <TR>
    <TD><B>name</B></TD>
    <TD><B>description</B></TD></TR>
  <TR>
    <TD nowrap>struts.addForward(String alias, String path, boolean redirect)</TD>
    <TD>Add ActionForward<br>
    	<b>Option:</b> addForward will lookup the forward's name between "_**name**."
        Example: "/customer_view.jsp" -> "view". If the lookup fails the default name is "success".
	</TD>
  </TR>
  <TR>
    <TD nowrap>struts.addGlobalForward(String alias, String path, boolean redirect)</TD>
    <TD>Simular to addActionForward but registers the Forward as global.
	</TD>
  </TR>
    <TR>
    <TD nowrap>struts.setPackageBy(String packageby)</TD>
    <TD>Set jsp lookup mode<li>ActionConfig.PACKAGEBY_LAYER<li>ActionConfig.PACKAGEBY_FEATURE.
	</TD>
  </TR>
  <TR>
    <TD nowrap>struts.setForm(class ActionForm)</TD>
    <TD>Manually assign an ActionForm to the Action.<br><b>Option:</b> If not provided Strutter will search
    for the ActionForm following two naming conventions:<br>
    	Class <code>CustomerEditAction</code> will search for
    		<code>CustomerEditActionForm</code> and <code>CustomerActionForm</code> (in this order)
	</TD>
  </TR>
  <TR>
    <TD nowrap>struts.setValidate(boolean enable)</TD>
    <TD>Enable Validation.
	</TD>
  </TR>
  <TR>
    <TD nowrap>struts.setInput(String path)</TD>
    <TD>Set path for the input page. Used by Struts to redirect to when validation failed.
	</TD>
  </TR>
    <TR>
    <TD nowrap>struts.setParameter(String parameter)</TD>
    <TD>Set additional parameter used by ActionDispatcher class. Default value is "action".
	</TD>
  </TR>
  <TR>
    <TD nowrap>struts.setPath(String path)</TD>
    <TD>Set path for this action. If not provided Strutter will build the path
    following this conversation: <code>CustomerAction</code> -> <code>customer</code>.
	</TD>
  </TR>
  <TR>
    <TD nowrap>struts.setScope(String scope)</TD>
    <TD>Set scope of ActionForm.
	</TD>
  </TR>
  <TR>
    <TD nowrap>struts.setUnknown(boolean enable)</TD>
    <TD>Set this action as default action for the application.
	</TD>
  </TR>
  <TR>
    <TD nowrap>struts.setRoles(String roles)</TD>
    <TD>Comma separated list of roles.
	</TD>
  </TR>
  </TBODY></TABLE>


<p>
<H1><a name="strutterview">Strutter View</a></H1><B>Features</B>
<LI>Automatic ActionForm population in standard HTML Tags
<LI>Option Tag handler with multiple sources
<LI>adds hidden field for <code>action</code> handler
<LI>adds Javascript to submit form <code>subber</code>
<LI>adds Javascript to submit form confirmed <code>subberconfirm</code>
<LI>adds keep alive, server is pinged via AJAX and the session will not expired
<LI>adds background processing <code>subbernowait</code>


<P><a name="strutterviewexample"><B>Example 1</B></a><BR>

<pre>
  &lt;form action="sample.do"&gt;

    &lt;select name="anrede"&gt;
      &lt;option id="anreden" /&gt;
    &lt;/select&gt;

    &lt;input type="text" name="firstname"&gt;

    &lt;input type="button" onclick="subber('update')" value="OK"&gt;

  &lt;/form&gt;
</pre>

This example will map the ActionForm attribut <code>anrede</code> to
the select field anrede and firstname to the corresponding
form attribut.<br>
The option values can be added manual or will be read from the attribute
<code>anreden</code>. It will try to locate it in <code>session, request, actionform</code>
(in this order).
Nothing special just simple HTML.

<P><a name="strutterviewerror"><B>Error Handler</B></a><BR>

There is a simple extention to handle error messages:

<pre>
&lt;input type="text" name="firstname" error="behind"&gt;
</pre>

<table border="1">
	<tr><td><b>error</td><td><b>text</td><td><b>class</td></tr>
	<tr><td>behind</td><td>Error text behind the control</td><td>error_label</td></tr>
	<tr><td>before</td><td>Error text before the control</td><td>error_label</td></tr>
	<tr><td>class</td><td>Set error class in case of error</td><td>error_control</td></tr>
</table>
<p>
The error message for each control is identified by the controls
name.

<P><B>div / span</B><BR>

Show property with id <code>label.name</code>:
<pre>
&lt;span type="resource" id="label.name"/&gt;
</pre>

Show all messages as list:
<pre>
&lt;div type="messages" /&gt;
</pre>

Show all errors as list:
<pre>
&lt;div type="errors" /&gt;
</pre>

Show error with id <code>firstname</code>:
<pre>
&lt;div type="error" id="firstname"/&gt;
</pre>


<b>Disable processing a form element</b><br>

To disable processing of a single form element add the attribute <code>nofill="nofill"</code>





<P><B><a name="strutterviewinstall">Installation</a></B><BR>
Strutter View is implemented as Filter. To get it
running in just add the <CODE>stutter.jar</CODE> and <CODE>htmlparser.jar</CODE>
to your WEB-INF/lib and add the following tag to your web.xml. <PRE>&lt;filter&gt;
  &lt;filter-name&gt;strutterview&lt;/filter-name&gt;
  &lt;filter-class&gt;strutter.view.PageFilter&lt;/filter-class&gt;
&lt;/filter&gt;

&lt;filter-mapping&gt;
  &lt;filter-name&gt;strutterview&lt;/filter-name&gt;
  &lt;url-pattern&gt;*.do&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</PRE>The rendered page will be processed by the filter. All <CODE>INPUT,
SELECT, TEXTAREA</CODE> are compared with the ActionForm and the tags value is
filled with the forms content of the corresponding attibute.



<H1><a name="struttergimmicks">Strutter Extentions</a></H1>
<B>Features</B>
<li>ActionHelper
<li>Formless Action
<li>Plain Action
<li>Interceptor (Action and Request based)

<p>

<a name="simplifiederrorhandling"><B>ActionHelper</B></a><BR>

The <code>ActionHelper</code> provides direct access to the request context.<br>
The following static functions are provided:

<p>
To add an <code>error</code> or <code>message</code> to your request just
call the <code>addError(...)</code> or <code>addMessage(...)</code> function.
You do not need to take care about the ArrayList handling you normaly have to.
<p>



<a name="struttergimmicksformless"><B>Formless Action</B></a><BR>

<li>FormlessDispatchAction
<li>FormlessAction

<p>

Implement the <code>FormlessInterface</code> in your ActionClass. Your Action will behave
like a ActionFomr. All Form attributes can be included directly in the action now. 
The implementation is thread safe! 
You can access the form in the JSP like any other form.<br>
Traditional Struts Tag are working properly.
<p>
<b>If you provide an <code>ActionForm</code> the Formless funcionality 
is disabled automaticaly and the <code>ActionForm</code> will be filled instead! </b> 
<p>

<PRE>/* The Action */
package example;

public class CustomerAction extends FormlessDispatchAction implements ConfigInterface
{
  public void config(ActionConfig struts) {
    struts.addForward("/customer_view.jsp");
  }

  public void reset() {
  }

  public ActionForward view() {

    return ActionHelper.findForward("view");
  }

  String memo; // add some form attributes (They are handled Thread Safe)
  
  ... getter and setter for "memo" ...
}
</PRE>

<a name="struttergimmicksformlessplain"><B>Plain Action</B></a><BR>

<li>PlainDispatchAction
<li>PlainAction

<p>

Subclass your <code>Action</code> class from one of the above classes
allows you to use a simpler Action Method.<br>
It has no parameter instead of the four standard Struts parameter. 
(mapping, actionform, request, response)
<p>
They still can be accessed via <code>ActionHelper</code> see above.<br>
<p>
If the action has both Action Method with and without parameter. 
The one with parameter will have priority one.

<PRE>/* The Action */
package example;

public class CustomerAction extends PlainDispatchAction implements ConfigInterface, FormlessInterface
{
  public void config(ActionConfig struts) {
    struts.addForward("/customer_view.jsp");
  }

  public ForwardAction view() {

    ...
	  ActionHelper.getRequest();  // ThreadLocal access to environment	
    ...

	  return ActionHelper.findForward("view");
  }

  public void reset() {
  }

  String memo; // add some form attributes (They are handled Thread Safe)
}
</PRE>


<span style="color: red"> TODO add documentation.</span>


</td>
</tr>
</table>


<hr>

<b>Contact</b>: <a href="mailto:strutter@ingoharbeck.de">strutter@ingoharbeck.de</a>

<a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=167343&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
</BODY></HTML>




